<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ShareBoost</title>
  <link rel="stylesheet" href="public/style.css">
</head>
<body>
  <h1>ðŸš€ ShareBoost</h1>
  <form id="shareForm">
    <label>FB Cookie (AppState JSON):</label><br>
    <textarea id="cookie" rows="5" required></textarea><br>

    <label>Post URL:</label><br>
    <input type="text" id="url" required><br>

    <label>Amount (ilang shares):</label><br>
    <input type="number" id="amount" required><br>

    <label>Interval (seconds):</label><br>
    <input type="number" id="interval" required><br>

    <button type="submit">Start Boost</button>
  </form>

  <h2>ðŸ“Š Sessions</h2>
  <table border="1" id="sessionsTable">
    <thead>
      <tr>
        <th>Session</th>
        <th>URL</th>
        <th>Progress</th>
        <th>Target</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const form = document.getElementById("shareForm");
    const tableBody = document.querySelector("#sessionsTable tbody");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const cookie = document.getElementById("cookie").value;
      const url = document.getElementById("url").value;
      const amount = document.getElementById("amount").value;
      const interval = document.getElementById("interval").value;

      const res = await fetch("/api/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ cookie, url, amount, interval })
      });

      const data = await res.json();
      alert(JSON.stringify(data));
    });

    async function loadSessions() {
      const res = await fetch("/total");
      const sessions = await res.json();
      tableBody.innerHTML = "";
      sessions.forEach(s => {
        tableBody.innerHTML += `
          <tr>
            <td>${s.session}</td>
            <td>${s.url}</td>
            <td>${s.count}</td>
            <td>${s.target}</td>
          </tr>`;
      });
    }

    setInterval(loadSessions, 3000); // update table every 3s
  </script>
</body>
</html>
